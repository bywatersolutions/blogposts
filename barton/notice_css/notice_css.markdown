# Setting Up Print Notices to Print Address Block in the Window of a #10 Windowed Envelope

## Overview
Many of our partner libraries want to send printed notices to borrowers
who have not supplied email addresses. The most obvious solution is to
print the text sent in the emails generated by `overdue_notices.pl`. This
has some drawbacks however -- there are no page breaks between notices,
and the notices themselves may not be formatted as you want them to be.

In this blog post, we will cover how to add page breaks, as well as how
to print the borrower's postal address in a location on the printed page
that will show in the window of a standard #10 envelope.

Here are the steps that you need to take:

1. Create a CSS style sheet to format your printed notices
2. Set the `NoticeCSS` system preferrence to point to your style sheet
3. Set up the print section of the notices to print
4. Enable `print` under Overdue Notice Triggers for the notices that you want to print
5. Set up the `gather_print_notices.pl` cron job

The `gather_print_notices.pl` cron job will generate and email an HTML
attachment which is styled using the CSS in step 1. When you view that
attachment in your web browser, you will see that individual notices show,
(and can be printed on their own page). Furthermmore, because the CSS
is not in the notice itself, you will be able to make changes to the
styling without generating new notices.

## How to do it
<!-- Create a CSS style sheet to format your printed notices -->
### Create a CSS style sheet
The styling of html pages is handled by 'Cascading Style Sheets', aka
CSS. In this case, we will be creating CSS files that will be hosted
outside of Koha's web server. There are various ways to create and
host CSS files. Github provides good versioning, sharing and hosting,
so that's what we'll use here.

#### Set up a github account
If you do not already have a github account, go to https://github.com/ and
click the green 'Sign up' button. Write down your username; you will need it
later in this article.

#### Fork the `bywatersolutions/kohacss` archive.
We have created an existing CSS file which contains code to paginate the notices and add the address window. You will need your own copy of this file that you can edit to fit printer margins, and/or style as you see fit.

Go to https://github.com/bywatersolutions/kohacss

Click on the 'Fork' button on the upper right hand side of the page:

> !["Fork your own copy of bywatersolutions/kohacss to your account"](images/github_forkbutton.png) 

This will bring up a screen asking "Where should we fork this repository?". Choose your username:

> ![github user account avatar](images/github_where_should_we_fork.png)

This will 'fork' or copy the bywatersolutions/kohacss repository into your own account.

Click the Settings link:

> ![github settings link](images/github_settings_button.png)

Scroll down to `GitHub Pages` and change Source from 'None' to 'Master Branch', then click save.

> ![Change to master branch](images/github_pages_choose_master_branch.png)

The file is then available at `https://<<YOUR USER NAME>>.github.io/kohacss/<<PATH TO CSS FILE>>`

For instance, the github user `bartonski` has made the file `NoticeCSS/envelope_window.css` available at

[https://bartonski.github.io/kohacss/NoticeCSS/envelope_window.css](https://bartonski.github.io/kohacss/NoticeCSS/envelope_window.css)

You can edit the CSS file by navigating back to your `kohacss` directory, then clicking on the `NoticeCss` directory, 
then on `envelope_window.css`. From there, you can click on the edit icon, which looks like a pencil:

> !["Edit this file"](images/github_edit_icon.png)

<!-- Set the `NoticeCSS` system preferrence to point to your style sheet --> 
### Set up `NoticeCSS` system preferrence.

In Koha, Go to Home > Administration > System preferences, and click on the `Circulation` tab. Scroll down to
`NoticeCSS`, and enter `https://<<YOUR GITHUB USERNAME>>.github.io/kohacss/NoticeCSS/envelope_window.css`. Save the system preference.

<!-- Set up the print section of the notices to print --> 
### Set up the print section of the notices to print

Go to Home > Tools > Notices and Slips. Click 'Edit' on one of the overdue notices, and then click the 'Print' section.

Make sure that 'HTML message' is checked. Fill in the Message Subject. IN the body, you will want to create two HTML 'div' sections. One will have class="address", and will contain your address block. The other will have class="content", and will contain the remainder of the notice.

Here's an example:

    <div class="address">
    <<borrowers.firstname>> <<borrowers.surname>>
    <<borrowers.address>>
    <<borrowers.address2>>
    <<borrowers.city>>, <<borrowers.state>> <<borrowers.zipcode>>
    </div>
    <div class="content">
    <<today>>

    Dear <<borrowers.firstname>> <<borrowers.surname>>,

    According to our current records, you have item(s) that is/are overdue.  Please return item(s) as soon as possible.  You will be unable to use your library card until the item(s) is/are returned and the fines are paid..

    The following item(s) is/are currently overdue:

    <item>"<<biblio.title>>" by <<biblio.author>>, <<items.itemcallnumber>>, Barcode: <<items.barcode>>, Due Date: <<issues.date_due>></item>

    If you have questions regarding this notice, please call the Alturas main library at 530-233-6340.  Thank-you for your prompt attention to this matter. 

    <<branches.branchname>> Staff
    <<branches.branchaddress1>>
    <<branches.branchcity>>,<<branches.branchstate>><<branches.branchzip>>  
    Phone: <<branches.branchphone>>
    Email: <<branches.branchemail>>
    </div>

You will want to replicate this process for all of your overdue notices, adding `<div class="address">..</div>` and `<div class="content">..</div>` in each print notice.

<!-- Enable `print` under Overdue Notice Triggers for the notices that you want to print --> 
### Enable `print` under Overdue Notice Triggers for notices

<!-- Set up the `gather_print_notices.pl` cron job --> 
### Set up the `gather_print_notices.pl` cron job 
- Configuration of `gather_print_notices.pl` is beyond the scope of this blog post; documentation can be found at ... 
